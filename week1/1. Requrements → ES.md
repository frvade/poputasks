### Авторизация в таск-трекере должна выполняться через общий сервис авторизации UberPopug Inc (у нас там инновационная система авторизации на основе формы клюва).
Actor: User with role manager or admin  
Command: Register User  
Data: new User  
Event: User.Registered

### Новые таски может создавать кто угодно (администратор, начальник, разработчик, менеджер и любая другая роль). У задачи должны быть описание, статус (выполнена или нет) и попуг, на которого заассайнена задача.
Actor: User    
Command: Add Task  
Data: new Task  
Event: Task.Added

Actor: Task.Added    
Command: Assign Task  
Data: not-assigned Task  
Event: Task.Added

### Менеджеры или администраторы должны иметь кнопку «заассайнить задачи», которая возьмёт все открытые задачи и рандомно заассайнит каждую на любого из сотрудников (**Update:** кроме менеджера и администратора) . Не успел закрыть задачу до реассайна — сорян, делай следующую.
    1. Ассайнить задачу можно на кого угодно (**Update:** кроме менеджера и администратора), это может быть любой существующий аккаунт из системы.
    2. Ассайнить задачу можно только кнопкой «заассайнить задачи»
    3. При нажатии кнопки «заассайнить задачи» все текущие не закрытые задачи должны быть случайным образом перетасованы между каждым аккаунтом в системе
    4. Мы не заморачиваемся на ограничение по нажатию на кнопку «заассайнить задачи». Её можно нажимать хоть каждую секунду.
    5. На одного сотрудника может выпасть любое количество новых задач, может выпасть ноль, а может и 10.
Actor: User with role manager or admin  
Command: Reassign Tasks (loop команд Assign Task, предыдущая команда)  
Data: Open Tasks  

### Каждый сотрудник должен иметь возможность видеть в отдельном месте список заассайненных на него задач + отметить задачу выполненной.
Actor: User    
Command: Complete Task  
Data: User Task  
Event: Task.Completed

### Расценки:
    1. цены на задачу определяется единоразово, в момент появления в системе (можно с минимальной задержкой)
        - **Updated:** цены рассчитывается без привязки к сотруднику
    2. **Updated:** формула, которая говорит сколько списать денег с сотрудника при ассайне задачи — `rand(-10..-20)$`
    3. **Updated:** формула, которая говорит сколько начислить денег сотруднику для выполненой задачи — `rand(20..40)$`
    4. деньги списываются сразу после ассайна на сотрудника, а начисляются после выполнения задачи.
Actor: Task.Assigned  
Command: Price Task  
Data: Assigned Task  
Event: Task.Priced

Actor: Task.Priced  
Command: add transaction  
Data: Transaction (withdraw)  
Event: Transaction.Added

Actor: Task.Completed  
Command: add transaction (предыдущая команда)  
Data: Transaction (deposit)

### В конце дня необходимо:
    1. считать сколько денег сотрудник получил за рабочий день
    2. отправлять на почту сумму выплаты.
    3. отрицательный баланс переносится на следующий день. Единственный способ его погасить - закрыть достаточное количество задач в течении дня.
Actor: Cronjob  
Command: Payout accounts  
Data: positive Accounts  
Event: Account.PaidOut

Actor: Account.PaidOut  
Command: Notify user  
Data: Account, amount  
Event: User.PayoutNotified

### После выплаты баланса (в конце дня) он должен обнуляться, и в аудитлоге всех операций аккаунтинга должно быть отображено, что была выплачена сумма.
Actor: UserAccount.PaidOut  
Command: add transaction (выше)  
Data: Transaction (payout)

## Query / Read model
### У каждого из сотрудников должен быть свой счёт, который показывает, сколько за сегодня он получил денег. У счёта должен быть аудитлог того, за что были списаны или начислены деньги, с подробным описанием каждой из задач.
Query: Account + transactions (with source)